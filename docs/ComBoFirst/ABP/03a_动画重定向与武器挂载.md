# 03a. æ­¦å™¨ Socket ä¸æŒ‚è½½ç³»ç»Ÿ

> **é¢„è®¡è€—æ—¶**: 30 åˆ†é’Ÿ  
> **å‰ç½®æ¡ä»¶**: éª¨éª¼å…¼å®¹ï¼ˆå¯ç›´æ¥ä½¿ç”¨ç´ æåŒ…åŠ¨ç”»ï¼‰
> **æœ¬ç« äº§å‡º**: æ­¦å™¨ Socket ç³»ç»Ÿ + å¯è£…å¤‡çš„æ­¦å™¨

---

## ğŸ¯ æœ¬ç« ç›®æ ‡

1. âœ… åˆ›å»º **æ­¦å™¨ Socket** æŒ‚ç‚¹
2. âœ… åˆ›å»º **æ­¦å™¨ Actor**
3. âœ… å®ç°è¿è¡Œæ—¶ **æ­¦å™¨æŒ‚è½½/å¸è½½**
4. âœ… è”åŠ¨ **åŠ¨ç”»å±‚åˆ‡æ¢**

---

## ğŸ“š èƒŒæ™¯è¯´æ˜

### ä½ çš„æƒ…å†µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… éª¨éª¼å…¼å®¹ - ä¸éœ€è¦ IK Retargeterï¼                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ç´ æåŒ…éª¨éª¼ (å¸¦æ­¦å™¨)                 ä½ çš„è§’è‰²éª¨éª¼ (æ— æ­¦å™¨)        â”‚
â”‚  SK_Mannequin_KatanaV3              SK_Mannequin                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ root               â”‚    =     â”‚ root               â”‚      â”‚
â”‚  â”‚ â””â”€â”€ pelvis         â”‚    =     â”‚ â””â”€â”€ pelvis         â”‚      â”‚
â”‚  â”‚     â””â”€â”€ spine_*    â”‚    =     â”‚     â””â”€â”€ spine_*    â”‚      â”‚
â”‚  â”‚     â””â”€â”€ hand_r     â”‚    =     â”‚     â””â”€â”€ hand_r     â”‚      â”‚
â”‚  â”‚         â””â”€â”€ weapon â”‚    â‰      â”‚         â””â”€â”€ (æ— )    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                  â”‚
â”‚  äººä½“éª¨éª¼ä¸€è‡´ â†’ åŠ¨ç”»ç›´æ¥å¯ç”¨ï¼                                    â”‚
â”‚  æ­¦å™¨éª¨éª¼ç¼ºå¤± â†’ UE è‡ªåŠ¨å¿½ç•¥ï¼Œä¸å½±å“æ’­æ”¾                           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è§£å†³æ–¹æ¡ˆ

```
åŠ¨ç”»ç›´æ¥ç”¨ + æ­¦å™¨ Socket æŒ‚è½½ = å®Œç¾ï¼
```

---

## ğŸ“¦ ç¬¬ä¸€éƒ¨åˆ†ï¼šæ­¦å™¨ Socket åˆ›å»º

### Step 1: æ‰“å¼€éª¨éª¼èµ„äº§

1. **æ‰¾åˆ°ä½ çš„éª¨éª¼**:
   ```
   Content/Characters/Heroes/Mannequin_Mesh/Meshes/SK_Mannequin.uasset
   ```
   (æˆ–è€…ä½ è§’è‰²ä½¿ç”¨çš„ Skeletal Mesh)

2. **åŒå‡»æ‰“å¼€**

3. **ç¡®ä¿æ˜¾ç¤º Skeleton Tree é¢æ¿** (Window â†’ Skeleton Tree)

### Step 2: æ·»åŠ æ­¦å™¨ Socket

1. **å³æ‰‹æ­¦å™¨ Socket**:
   - åœ¨ Skeleton Tree ä¸­æ‰¾åˆ° `hand_r` éª¨éª¼
   - å³é”® â†’ **Add Socket**
   - å‘½å: `socket_weapon_r`

2. **å·¦æ‰‹æ­¦å™¨/ç›¾ç‰Œ Socket** (å¯é€‰):
   - æ‰¾åˆ° `hand_l` éª¨éª¼
   - å³é”® â†’ Add Socket
   - å‘½å: `socket_weapon_l`

3. **èƒŒéƒ¨æ­¦å™¨ Socket** (å¯é€‰ï¼Œç”¨äºæ”¶åˆ€):
   - æ‰¾åˆ° `spine_03` æˆ– `spine_04`
   - å³é”® â†’ Add Socket
   - å‘½å: `socket_weapon_back`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Skeleton Tree (æ·»åŠ  Socket å)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â–¼ root                                                          â”‚
â”‚    â–¼ pelvis                                                      â”‚
â”‚      â–¼ spine_01                                                  â”‚
â”‚        â–¼ spine_02                                                â”‚
â”‚          â–¼ spine_03                                              â”‚
â”‚            â””â”€â”€ ğŸ“Œ socket_weapon_back                            â”‚
â”‚          ...                                                     â”‚
â”‚      â–¼ clavicle_r                                                â”‚
â”‚        â–¼ upperarm_r                                              â”‚
â”‚          â–¼ lowerarm_r                                            â”‚
â”‚            â–¼ hand_r                                              â”‚
â”‚              â””â”€â”€ ğŸ“Œ socket_weapon_r   â† æ–°æ·»åŠ çš„ Socket         â”‚
â”‚      â–¼ clavicle_l                                                â”‚
â”‚        ...                                                       â”‚
â”‚            â–¼ hand_l                                              â”‚
â”‚              â””â”€â”€ ğŸ“Œ socket_weapon_l   â† æ–°æ·»åŠ çš„ Socket         â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Step 3: è°ƒæ•´ Socket Transform

1. **é€‰ä¸­ Socket** (å¦‚ `socket_weapon_r`)

2. **åœ¨ Details é¢æ¿è®¾ç½®é¢„è§ˆ**:
   - æ‰¾åˆ° **Preview Asset**
   - é€‰æ‹© `SM_KatanaV3` 
   - è·¯å¾„: `AnimAssetsCombatMasterAnimBundle/Weapon/Katana/SM_KatanaV3`

3. **è°ƒæ•´ä½ç½®ç›´åˆ°æ­¦å™¨æ¡æŒæ­£ç¡®**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  socket_weapon_r å‚è€ƒå€¼ (éœ€æ ¹æ®å®é™…è°ƒæ•´)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Relative Location:  X: 0    Y: 0    Z: 0                       â”‚
â”‚  Relative Rotation:  X: 0    Y: 0    Z: 0    (æˆ–éœ€è¦æ—‹è½¬90Â°ç­‰)  â”‚
â”‚  Relative Scale:     X: 1    Y: 1    Z: 1                       â”‚
â”‚                                                                  â”‚
â”‚  ğŸ’¡ æç¤º:                                                        â”‚
â”‚  - è¾¹è°ƒæ•´è¾¹çœ‹é¢„è§ˆçª—å£                                            â”‚
â”‚  - å¯ä»¥æ’­æ”¾ Idle åŠ¨ç”»æ¥æ£€æŸ¥æ¡æŒæ•ˆæœ                              â”‚
â”‚  - æ­¦å™¨æŸ„åº”è¯¥åœ¨æ‰‹å¿ƒä½ç½®                                          â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

4. **æ’­æ”¾åŠ¨ç”»é¢„è§ˆ**:
   - åœ¨ Asset Browser ä¸­æ‹–å…¥ `Anim_KT3_Idle_RM`
   - æ£€æŸ¥æ­¦å™¨æ˜¯å¦è·Ÿéšæ‰‹éƒ¨æ­£ç¡®è¿åŠ¨

### Step 4: ä¿å­˜

- **Ctrl + S** ä¿å­˜ Skeleton èµ„äº§
- Socket ä¿¡æ¯ä¼šä¿å­˜åœ¨éª¨éª¼ä¸­ï¼Œæ‰€æœ‰ä½¿ç”¨æ­¤éª¨éª¼çš„è§’è‰²éƒ½å¯ä»¥ä½¿ç”¨

---

## ğŸ“¦ ç¬¬äºŒéƒ¨åˆ†ï¼šæ­¦å™¨ Actor ç±»

### C++ æ­¦å™¨åŸºç±»

```cpp filePath=Source/DJ01/Weapons/DJ01WeaponBase.h
// DJ01WeaponBase.h
#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Actor.h"
#include "DJ01WeaponBase.generated.h"

UENUM(BlueprintType)
enum class EWeaponType : uint8
{
    Unarmed,
    Katana,
    SwordShield,
    Pistol,
    Rifle
};

UCLASS(Abstract)
class DJ01_API ADJ01WeaponBase : public AActor
{
    GENERATED_BODY()
    
public:
    ADJ01WeaponBase();

    // æ­¦å™¨ç±»å‹
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly, Category = "Weapon")
    EWeaponType WeaponType = EWeaponType::Unarmed;
    
    // å¯¹åº”çš„åŠ¨ç”»å±‚ç±»
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly, Category = "Weapon|Animation")
    TSubclassOf<UAnimInstance> AnimLayerClass;
    
    // æŒ‚è½½ Socket åç§°
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly, Category = "Weapon|Socket")
    FName EquippedSocketName = "socket_weapon_r";
    
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly, Category = "Weapon|Socket")
    FName HolsteredSocketName = "socket_weapon_back";

    // æ­¦å™¨ Mesh
    UPROPERTY(VisibleAnywhere, BlueprintReadOnly, Category = "Components")
    TObjectPtr<UStaticMeshComponent> WeaponMesh;

    // è£…å¤‡/æ”¶èµ·
    UFUNCTION(BlueprintCallable, Category = "Weapon")
    void AttachToCharacter(ACharacter* Character, bool bEquipped = true);
    
    UFUNCTION(BlueprintCallable, Category = "Weapon")
    void DetachFromCharacter();
};
```

```cpp filePath=Source/DJ01/Weapons/DJ01WeaponBase.cpp
// DJ01WeaponBase.cpp
#include "DJ01WeaponBase.h"
#include "GameFramework/Character.h"
#include "Components/SkeletalMeshComponent.h"

ADJ01WeaponBase::ADJ01WeaponBase()
{
    PrimaryActorTick.bCanEverTick = false;

    // åˆ›å»ºæ­¦å™¨ Mesh ç»„ä»¶
    WeaponMesh = CreateDefaultSubobject<UStaticMeshComponent>(TEXT("WeaponMesh"));
    RootComponent = WeaponMesh;
    
    // é»˜è®¤å…³é—­ç¢°æ’
    WeaponMesh->SetCollisionEnabled(ECollisionEnabled::NoCollision);
}

void ADJ01WeaponBase::AttachToCharacter(ACharacter* Character, bool bEquipped)
{
    if (!Character) return;
    
    USkeletalMeshComponent* CharMesh = Character->GetMesh();
    if (!CharMesh) return;
    
    // é€‰æ‹©æŒ‚è½½ç‚¹
    FName SocketName = bEquipped ? EquippedSocketName : HolsteredSocketName;
    
    // æŒ‚è½½åˆ°è§’è‰²
    AttachToComponent(
        CharMesh,
        FAttachmentTransformRules::SnapToTargetNotIncludingScale,
        SocketName
    );
}

void ADJ01WeaponBase::DetachFromCharacter()
{
    DetachFromActor(FDetachmentTransformRules::KeepWorldTransform);
}
```

### åˆ›å»º Katana æ­¦å™¨è“å›¾

1. **åˆ›å»ºè“å›¾**:
   - å³é”® â†’ Blueprint Class
   - Parent: `DJ01WeaponBase`
   - å‘½å: `BP_Weapon_Katana`

2. **é…ç½®**:
   ```
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  BP_Weapon_Katana - Details                                     â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚                                                                  â”‚
   â”‚  Weapon                                                          â”‚
   â”‚  â”œâ”€â”€ Weapon Type: Katana                                        â”‚
   â”‚                                                                  â”‚
   â”‚  Weapon | Animation                                              â”‚
   â”‚  â”œâ”€â”€ Anim Layer Class: ABP_AnimLayer_Katana                     â”‚
   â”‚                                                                  â”‚
   â”‚  Weapon | Socket                                                 â”‚
   â”‚  â”œâ”€â”€ Equipped Socket Name: socket_weapon_r                      â”‚
   â”‚  â””â”€â”€ Holstered Socket Name: socket_weapon_back                  â”‚
   â”‚                                                                  â”‚
   â”‚  Components                                                      â”‚
   â”‚  â””â”€â”€ WeaponMesh                                                  â”‚
   â”‚      â””â”€â”€ Static Mesh: SM_KatanaV3                               â”‚
   â”‚                                                                  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   ```

---

## ğŸ“¦ ç¬¬ä¸‰éƒ¨åˆ†ï¼šè§’è‰²è£…å¤‡æ­¦å™¨

### åœ¨è§’è‰²ç±»ä¸­æ·»åŠ æ­¦å™¨ç®¡ç†

```cpp filePath=Source/DJ01/Character/DJ01CharacterBase.h (éƒ¨åˆ†)
// æ·»åŠ åˆ°è§’è‰²å¤´æ–‡ä»¶

// å‰å‘å£°æ˜
class ADJ01WeaponBase;

// åœ¨ç±»ä¸­æ·»åŠ 
public:
    // å½“å‰è£…å¤‡çš„æ­¦å™¨
    UPROPERTY(BlueprintReadOnly, Category = "Weapon")
    TObjectPtr<ADJ01WeaponBase> CurrentWeapon;
    
    // è£…å¤‡æ­¦å™¨
    UFUNCTION(BlueprintCallable, Category = "Weapon")
    void EquipWeapon(TSubclassOf<ADJ01WeaponBase> WeaponClass);
    
    // å¸ä¸‹æ­¦å™¨
    UFUNCTION(BlueprintCallable, Category = "Weapon")
    void UnequipWeapon();

protected:
    // æ›´æ–°åŠ¨ç”»å±‚
    void UpdateAnimationLayer(TSubclassOf<UAnimInstance> NewLayerClass);
    
    // å½“å‰åŠ¨ç”»å±‚ç±»
    UPROPERTY()
    TSubclassOf<UAnimInstance> CurrentAnimLayerClass;
```

```cpp filePath=Source/DJ01/Character/DJ01CharacterBase.cpp (éƒ¨åˆ†)
// æ·»åŠ åˆ°è§’è‰²å®ç°æ–‡ä»¶

#include "Weapons/DJ01WeaponBase.h"

void ADJ01CharacterBase::EquipWeapon(TSubclassOf<ADJ01WeaponBase> WeaponClass)
{
    if (!WeaponClass) return;
    
    // å…ˆå¸ä¸‹å½“å‰æ­¦å™¨
    UnequipWeapon();
    
    // ç”Ÿæˆæ–°æ­¦å™¨
    FActorSpawnParameters SpawnParams;
    SpawnParams.Owner = this;
    
    CurrentWeapon = GetWorld()->SpawnActor<ADJ01WeaponBase>(
        WeaponClass, 
        FVector::ZeroVector, 
        FRotator::ZeroRotator, 
        SpawnParams
    );
    
    if (CurrentWeapon)
    {
        // æŒ‚è½½åˆ°è§’è‰²
        CurrentWeapon->AttachToCharacter(this, true);
        
        // åˆ‡æ¢åŠ¨ç”»å±‚
        UpdateAnimationLayer(CurrentWeapon->AnimLayerClass);
    }
}

void ADJ01CharacterBase::UnequipWeapon()
{
    if (CurrentWeapon)
    {
        CurrentWeapon->DetachFromCharacter();
        CurrentWeapon->Destroy();
        CurrentWeapon = nullptr;
    }
    
    // æ¢å¤é»˜è®¤åŠ¨ç”»å±‚ (Unarmed)
    UpdateAnimationLayer(nullptr);
}

void ADJ01CharacterBase::UpdateAnimationLayer(TSubclassOf<UAnimInstance> NewLayerClass)
{
    UAnimInstance* AnimInstance = GetMesh()->GetAnimInstance();
    if (!AnimInstance) return;
    
    // è§£é™¤æ—§çš„åŠ¨ç”»å±‚
    if (CurrentAnimLayerClass)
    {
        AnimInstance->UnlinkAnimClassLayers(CurrentAnimLayerClass);
    }
    
    // é“¾æ¥æ–°çš„åŠ¨ç”»å±‚
    if (NewLayerClass)
    {
        AnimInstance->LinkAnimClassLayers(NewLayerClass);
        CurrentAnimLayerClass = NewLayerClass;
    }
    else
    {
        // é»˜è®¤ä½¿ç”¨ Unarmed å±‚
        // AnimInstance->LinkAnimClassLayers(ABP_AnimLayer_Unarmed::StaticClass());
        CurrentAnimLayerClass = nullptr;
    }
}
```

---

## ğŸ“¦ ç¬¬å››éƒ¨åˆ†ï¼šè“å›¾ä¸­æµ‹è¯•

### æµ‹è¯•è£…å¤‡æ­¦å™¨

åœ¨å…³å¡è“å›¾æˆ–è§’è‰²è“å›¾ä¸­ï¼š

```
[Event BeginPlay]
       â”‚
       â–¼
[Delay 2.0s]  â† å»¶è¿Ÿä»¥è§‚å¯Ÿæ•ˆæœ
       â”‚
       â–¼
[Equip Weapon]
    â”‚
    â””â”€â”€ Weapon Class: BP_Weapon_Katana
```

### æŒ‰é”®åˆ‡æ¢æ­¦å™¨

```
[InputAction: 1 é”®]
       â”‚
       â–¼
[Equip Weapon: BP_Weapon_Katana]

[InputAction: 2 é”®]
       â”‚
       â–¼
[Equip Weapon: BP_Weapon_Pistol]

[InputAction: 0 é”®]
       â”‚
       â–¼
[Unequip Weapon]  â† åˆ‡æ¢å›ç©ºæ‰‹
```

---

## ğŸ“ æœ€ç»ˆæ–‡ä»¶ç»“æ„

```
Content/
â”œâ”€â”€ Characters/Heroes/
â”‚   â””â”€â”€ Mannequin_Mesh/Meshes/
â”‚       â””â”€â”€ SK_Mannequin.uasset            â† éª¨éª¼ (å« Socket)
â”‚
â”œâ”€â”€ Weapons/
â”‚   â”œâ”€â”€ Katana/
â”‚   â”‚   â””â”€â”€ BP_Weapon_Katana.uasset        â† æ­¦å™¨è“å›¾
â”‚   â”œâ”€â”€ Pistol/
â”‚   â”‚   â””â”€â”€ BP_Weapon_Pistol.uasset
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ AnimAssetsCombatMasterAnimBundle/      â† ç›´æ¥ä½¿ç”¨åŸå§‹åŠ¨ç”»ï¼
    â”œâ”€â”€ Animations/DynamicKatanaAnimsV3/
    â””â”€â”€ Weapon/Katana/SM_KatanaV3.uasset   â† æ­¦å™¨ Mesh

Source/DJ01/
â”œâ”€â”€ Weapons/
â”‚   â”œâ”€â”€ DJ01WeaponBase.h
â”‚   â””â”€â”€ DJ01WeaponBase.cpp
â””â”€â”€ Character/
    â””â”€â”€ (æ­¦å™¨è£…å¤‡é€»è¾‘)
```

---

## âœ… å®Œæˆæ£€æŸ¥æ¸…å•

### Socket ç³»ç»Ÿ
- [ ] åœ¨éª¨éª¼ä¸Šæ·»åŠ äº† `socket_weapon_r`
- [ ] (å¯é€‰) æ·»åŠ äº† `socket_weapon_l`
- [ ] (å¯é€‰) æ·»åŠ äº† `socket_weapon_back`
- [ ] ä½¿ç”¨ Preview Asset é¢„è§ˆä½ç½®æ­£ç¡®
- [ ] ä¿å­˜äº†éª¨éª¼èµ„äº§

### æ­¦å™¨ç³»ç»Ÿ
- [ ] åˆ›å»ºäº† `DJ01WeaponBase` C++ ç±» (æˆ–çº¯è“å›¾)
- [ ] åˆ›å»ºäº† `BP_Weapon_Katana` è“å›¾
- [ ] é…ç½®äº†æ­¦å™¨ Mesh (`SM_KatanaV3`)
- [ ] é…ç½®äº†å¯¹åº”åŠ¨ç”»å±‚ç±» (`ABP_AnimLayer_Katana`)

### è£…å¤‡æµ‹è¯•
- [ ] è§’è‰²å¯ä»¥è£…å¤‡æ­¦å™¨
- [ ] æ­¦å™¨æ­£ç¡®æŒ‚è½½åœ¨æ‰‹ä¸Š
- [ ] åŠ¨ç”»å±‚æ­£ç¡®åˆ‡æ¢ (Idle/Moving åŠ¨ä½œå˜åŒ–)
- [ ] å¯ä»¥å¸ä¸‹æ­¦å™¨æ¢å¤ç©ºæ‰‹

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q: æ­¦å™¨ä½ç½®ä¸å¯¹ï¼Ÿ

**A**: 
1. åœ¨éª¨éª¼ç¼–è¾‘å™¨ä¸­é€‰ä¸­ Socket
2. ä½¿ç”¨ Preview Asset é¢„è§ˆæ­¦å™¨
3. å¾®è°ƒ Relative Location/Rotation
4. æ’­æ”¾åŠ¨ç”»æ£€æŸ¥æ¡æŒæ•ˆæœ

### Q: åŠ¨ç”»æ’­æ”¾æ­£å¸¸ä½†æ­¦å™¨ä¸è·Ÿæ‰‹ï¼Ÿ

**A**: 
1. ç¡®è®¤ Socket æ˜¯ `hand_r` çš„å­çº§
2. æ£€æŸ¥ Attach æ—¶ä½¿ç”¨äº†æ­£ç¡®çš„ Socket åç§°
3. ç¡®è®¤ä½¿ç”¨ `SnapToTargetNotIncludingScale` è§„åˆ™

### Q: ç´ æåŒ…åŠ¨ç”»æ’­æ”¾æœ‰é—®é¢˜ï¼Ÿ

**A**: 
è™½ç„¶éª¨éª¼å…¼å®¹ï¼Œä½†å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æ£€æŸ¥åŠ¨ç”»çš„ Preview Mesh æ˜¯å¦èƒ½åˆ‡æ¢åˆ°ä½ çš„éª¨éª¼
2. å¦‚ä»æœ‰é—®é¢˜ï¼Œå¯èƒ½éœ€è¦åˆ›å»º IK Retargeter (è§é™„å½•)

### Q: å¦‚ä½•è®©æ­¦å™¨æœ‰ç¢°æ’ï¼Ÿ

**A**: 
1. åœ¨æ­¦å™¨ Actor ä¸­æ·»åŠ ç¢°æ’ç»„ä»¶
2. æˆ–åœ¨æ­¦å™¨ Mesh ä¸Šè®¾ç½® Simple Collision
3. æ”»å‡»æ—¶å¯ç”¨ç¢°æ’ï¼Œå…¶ä»–æ—¶å€™å…³é—­

---

## ğŸ“ é™„å½•ï¼šå¦‚æœéœ€è¦é‡å®šå‘

å¦‚æœä½ ä»¥åé‡åˆ°éª¨éª¼ä¸å…¼å®¹çš„æƒ…å†µï¼Œéœ€è¦ä½¿ç”¨ **IK Retargeter**ï¼š

1. **åˆ›å»º IK Rig**:
   - å³é”®éª¨éª¼ â†’ Create â†’ IK Rig
   - å®šä¹‰ Retarget Root å’Œå„ä¸ª Chain (Spine, LeftArm, RightArm ç­‰)

2. **åˆ›å»º IK Retargeter**:
   - å³é”® â†’ Animation â†’ IK Retargeter
   - è®¾ç½® Source å’Œ Target IK Rig
   - Chain åç§°éœ€è¦å¯¹åº”

3. **æ‰¹é‡é‡å®šå‘**:
   - é€‰ä¸­åŠ¨ç”» â†’ å³é”® â†’ Retarget Animations
   - é€‰æ‹© Retargeterï¼Œå¯¼å‡ºåˆ°æ–°è·¯å¾„

---

## ğŸ“ ä¸‹ä¸€æ­¥

Socket å’Œæ­¦å™¨æŒ‚è½½å®Œæˆåï¼Œç»§ç»­åˆ›å»º BlendSpace å’ŒåŠ¨ç”»å±‚ï¼š

ğŸ‘‰ **[è¿”å›ç¬¬ä¸‰ç« ï¼šBlendSpaceåˆ›å»º](./03_BlendSpaceåˆ›å»º.md)**

> ğŸ’¡ åˆ›å»º BlendSpace æ—¶ï¼Œ**ç›´æ¥ä½¿ç”¨ç´ æåŒ…åŸå§‹åŠ¨ç”»**ï¼
> è·¯å¾„: `AnimAssetsCombatMasterAnimBundle/Animations/DynamicKatanaAnimsV3/RootMotion/`