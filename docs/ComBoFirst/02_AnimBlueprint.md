# ç¬¬äºŒç« ï¼šåŠ¨ç”»è“å›¾è®¾è®¡

> **é¢„è®¡è€—æ—¶**: 3å°æ—¶  
> **å‰ç½®è¦æ±‚**: å·²å®Œæˆ [01_AnimationAssets.md](./01_AnimationAssets.md)  
> **æœ¬ç« ç›®æ ‡**: åˆ›å»ºä¸»åŠ¨ç”»è“å›¾ï¼Œè®¾è®¡çŠ¶æ€æœºï¼Œé…ç½®åŠ¨ç”»å±‚è°ƒç”¨

---

## ðŸ“‹ æœ¬ç« ä»»åŠ¡æ¸…å•

- [ ] ç†è§£åŠ¨ç”»è“å›¾æž¶æž„
- [ ] åˆ›å»º/é…ç½®ä¸»åŠ¨ç”»è“å›¾ (ABP_DJ01Character_Base)
- [ ] è®¾è®¡ç§»åŠ¨çŠ¶æ€æœº (LocomotionSM)
- [ ] é…ç½® Montage Slot èŠ‚ç‚¹
- [ ] é›†æˆ BindingSet å˜é‡
- [ ] è°ƒç”¨åŠ¨ç”»å±‚æŽ¥å£

---

## 2.1 åŠ¨ç”»è“å›¾æž¶æž„

### Lyra é£Žæ ¼æž¶æž„

æœ¬é¡¹ç›®é‡‡ç”¨ç±»ä¼¼ Lyra çš„åŠ¨ç”»å±‚æž¶æž„:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ABP_DJ01Character_Base                        â”‚
â”‚                     (ä¸»åŠ¨ç”»è“å›¾)                              â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚               AnimGraph                              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚          LocomotionSM (çŠ¶æ€æœº)              â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  Idle   â”‚ â†’ â”‚ Moving  â”‚ â†’ â”‚  Jump   â”‚   â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  State  â”‚   â”‚  State  â”‚   â”‚ States  â”‚   â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚   â”‚
â”‚  â”‚  â”‚       â”‚             â”‚                       â”‚    â”‚   â”‚
â”‚  â”‚  â”‚       â–¼             â–¼                       â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚     Animation Layer Calls            â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  FullBody_IdleState()                â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  FullBody_MovingState()              â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                         â”‚                            â”‚   â”‚
â”‚  â”‚                         â–¼                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚           Slot 'DefaultSlot'                â”‚    â”‚   â”‚
â”‚  â”‚  â”‚        (Montage æ’­æ”¾åœ¨æ­¤è¦†ç›–)                â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                         â”‚                            â”‚   â”‚
â”‚  â”‚                         â–¼                            â”‚   â”‚
â”‚  â”‚                   Output Pose                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ LinkAnimClassLayers
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Linked Animation Blueprints (æ­¦å™¨åŠ¨ç”»å±‚)                     â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   ALB_Katana    â”‚  â”‚ ALB_SwordShield â”‚  â”‚ ALB_TwinSword â”‚ â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚               â”‚ â”‚
â”‚  â”‚ FullBody_Idle() â”‚  â”‚ FullBody_Idle() â”‚  â”‚ FullBody_Idle â”‚ â”‚
â”‚  â”‚ â†’ åˆ€å¾…æœºåŠ¨ç”»    â”‚  â”‚ â†’ å‰‘ç›¾å¾…æœºåŠ¨ç”»   â”‚  â”‚ â†’ åŒåˆ€å¾…æœº     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…³é”®æ¦‚å¿µ

| æ¦‚å¿µ | è¯´æ˜Ž |
|------|------|
| **ä¸»åŠ¨ç”»è“å›¾ (ABP)** | åŒ…å«çŠ¶æ€æœºå’Œæ•´ä½“é€»è¾‘ï¼Œè°ƒç”¨åŠ¨ç”»å±‚æŽ¥å£ |
| **åŠ¨ç”»å±‚æŽ¥å£ (ALI)** | å®šä¹‰å¯è¢«è¦†ç›–çš„å‡½æ•°ï¼Œè¿”å›ž FPoseLink |
| **é“¾æŽ¥åŠ¨ç”»è“å›¾ (ALB)** | å®žçŽ°å…·ä½“æ­¦å™¨çš„åŠ¨ç”»ï¼Œè¢«è¿è¡Œæ—¶é“¾æŽ¥ |
| **çŠ¶æ€æœº (SM)** | ç®¡ç†ç§»åŠ¨/è·³è·ƒç­‰çŠ¶æ€è½¬æ¢ |
| **Slot** | Montage æ’­æ”¾çš„æ’æ§½ï¼Œè¦†ç›–çŠ¶æ€æœºè¾“å‡º |

---

## 2.2 ä¸»åŠ¨ç”»è“å›¾ç»“æž„

### æ–‡ä»¶ä½ç½®

```
Content/Characters/Heroes/HeroAnimations/
â”œâ”€â”€ ABP_DJ01Character_Base.uasset    â† ä¸»åŠ¨ç”»è“å›¾
```

### çˆ¶ç±»è®¾ç½®

ç¡®ä¿åŠ¨ç”»è“å›¾ç»§æ‰¿è‡ªé¡¹ç›®çš„ AnimInstance:

```
Parent Class: UDJ01AnimInstance
             (Source/DJ01/Animation/DJ01AnimInstance.h)
```

è¿™ä¸ªåŸºç±»æä¾›:
- `InitializeWithAbilitySystem()` - GAS é›†æˆ
- `GroundSpeed` / `GroundDistance` - ç‰©ç†çŠ¶æ€æ•°æ®
- `GameplayTagPropertyMap` - Tag åˆ°å˜é‡çš„æ˜ å°„

---

## 2.3 è®¾è®¡çŠ¶æ€æœº

### çŠ¶æ€æœºæ¦‚è§ˆ

```mermaid
stateDiagram-v2
    [*] --> Idle
    
    Idle --> Moving : GroundSpeed > 0
    Moving --> Idle : GroundSpeed â‰ˆ 0
    
    Idle --> JumpStart : bJumping = true
    Moving --> JumpStart : bJumping = true
    
    JumpStart --> FallLoop : èµ·è·³å®Œæˆ
    FallLoop --> Land : GroundDistance < 100
    Land --> Idle : è½åœ°å®Œæˆ
    Land --> Moving : è½åœ°å®Œæˆ & GroundSpeed > 0
```

### åˆ›å»ºçŠ¶æ€æœº

1. æ‰“å¼€ `ABP_DJ01Character_Base`
2. åœ¨ AnimGraph ä¸­ **å³é”®** â†’ **Add New State Machine**
3. å‘½åä¸º `LocomotionSM`

### é…ç½®çŠ¶æ€

#### State: Idle

```
1. åŒå‡»è¿›å…¥ Idle State
2. æ·»åŠ èŠ‚ç‚¹: Animation Layer â†’ FullBody_IdleState
3. è¿žæŽ¥åˆ° Output Animation Pose
```

è“å›¾ç¤ºæ„:
```
[FullBody_IdleState] â”€â”€â†’ [Output Animation Pose]
        â”‚
        â†“
   (è°ƒç”¨é“¾æŽ¥å±‚çš„å®žçŽ°)
```

#### State: Moving

```
1. åŒå‡»è¿›å…¥ Moving State
2. æ·»åŠ èŠ‚ç‚¹: Animation Layer â†’ FullBody_MovingState
3. è¿žæŽ¥åˆ° Output Animation Pose
```

#### State: JumpStart / FallLoop / Land

ç±»ä¼¼å¤„ç†ï¼Œåˆ†åˆ«è°ƒç”¨:
- `FullBody_JumpStartState()`
- `FullBody_FallLoopState()`
- `FullBody_LandState()`

### é…ç½®è½¬æ¢æ¡ä»¶

#### Idle â†’ Moving

1. ç‚¹å‡»è½¬æ¢ç®­å¤´
2. åŒå‡»è¿›å…¥ Transition Rule
3. æ·»åŠ é€»è¾‘:

```
// è“å›¾é€»è¾‘ (ä¼ªä»£ç )
Result = GroundSpeed > 1.0
```

è“å›¾èŠ‚ç‚¹:
```
[Get GroundSpeed] â”€â”€â†’ [>] â”€â”€â†’ [Result]
                      â†‘
                    [1.0]
```

#### Moving â†’ Idle

```
Result = GroundSpeed < 1.0
```

---

## 2.4 é…ç½® Montage Slot

### Slot èŠ‚ç‚¹ä½ç½®

Slot èŠ‚ç‚¹åº”æ”¾åœ¨çŠ¶æ€æœºè¾“å‡ºä¹‹åŽ:

```
[LocomotionSM] â”€â”€â†’ [Slot 'DefaultSlot'] â”€â”€â†’ [Output Pose]
```

### æ·»åŠ  Slot èŠ‚ç‚¹

1. åœ¨ AnimGraph ä¸­
2. çŠ¶æ€æœºè¾“å‡ºåŽæ·»åŠ  **Slot** èŠ‚ç‚¹
3. é…ç½® Slot Name: `DefaultGroup.DefaultSlot`

### å¤š Slot é…ç½® (é«˜çº§)

å¦‚æžœéœ€è¦ä¸Šä¸‹èº«åˆ†ç¦»:

```
                        â”Œâ”€â”€â†’ [UpperBody Slot] â”€â”€â”
[LocomotionSM] â”€â”€â†’ [Layered Blend per Bone] â”€â”€â†’ [Output Pose]
                        â””â”€â”€â†’ [LowerBody Slot] â”€â”€â”˜
```

é…ç½® Layered Blend per Bone:
- **Branch Filter**: 
  - Layer 0: `spine_01` (ä¸ŠåŠèº«)
  - Layer 1: `pelvis` (ä¸‹åŠèº«)

---

## 2.5 é›†æˆ BindingSet

### ç†è§£ BindingSet

BindingSet ç³»ç»Ÿè‡ªåŠ¨å°† GAS å±žæ€§/æ ‡ç­¾ç»‘å®šåˆ°åŠ¨ç”»å˜é‡:

```
                    BindingSet é…ç½®
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              è‡ªåŠ¨ç”Ÿæˆä»£ç                         â”‚
â”‚  DJ01_DECLARE_BINDING_SET(StatusCondition)      â”‚
â”‚                                                  â”‚
â”‚  bool bIsStunned;     â†â”€â”€ Status.Condition.Stunned
â”‚  bool bIsRooted;      â†â”€â”€ Status.Condition.Rooted
â”‚  float CurrentHealth; â†â”€â”€ Attribute.Health.Current
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åœ¨åŠ¨ç”»è“å›¾ä¸­ä½¿ç”¨

1. **ç¡®ä¿å˜é‡å­˜åœ¨**:
   
   åœ¨ `DJ01AnimInstance.h` ä¸­ï¼Œé€šè¿‡å®å£°æ˜Ž:
   ```cpp
   // å¼•å…¥ BindingSet å˜é‡
   DJ01_DECLARE_BINDING_SET(StatusCondition)
   ```

2. **åœ¨è“å›¾ä¸­è¯»å–**:
   
   è¿™äº›å˜é‡åœ¨è“å›¾ä¸­å¯ç›´æŽ¥è®¿é—®:
   ```
   [Get bIsStunned] â”€â”€â†’ [Branch] â”€â”€â†’ æ’­æ”¾çœ©æ™•åŠ¨ç”»
   ```

3. **å…¸åž‹ä½¿ç”¨åœºæ™¯**:
   
   | å˜é‡ | æ¥æºæ ‡ç­¾ | ç”¨é€” |
   |------|---------|------|
   | `bIsStunned` | `Status.Condition.Stunned` | æ’­æ”¾çœ©æ™•åŠ¨ç”» |
   | `bIsRooted` | `Status.Condition.Rooted` | ç¦æ­¢ç§»åŠ¨åŠ¨ç”» |
   | `bIsDead` | `Status.Condition.Dead` | æ’­æ”¾æ­»äº¡åŠ¨ç”» |

---

## 2.6 è°ƒç”¨åŠ¨ç”»å±‚

### åŠ¨ç”»å±‚æŽ¥å£å®šä¹‰

é¡¹ç›®å·²å®šä¹‰ `IALI_DJ01AnimLayers` æŽ¥å£:

```cpp filePath=Source/DJ01/Animation/ALI_DJ01AnimLayers.h
// å…¨èº«ç§»åŠ¨å±‚
FPoseLink FullBody_IdleState();
FPoseLink FullBody_MovingState();
FPoseLink FullBody_JumpStartState();
FPoseLink FullBody_FallLoopState();
FPoseLink FullBody_LandState();

// ä¸Šèº«è¦†ç›–å±‚
FPoseLink UpperBody_Overlay();
```

### åœ¨çŠ¶æ€æœºä¸­è°ƒç”¨

åœ¨æ¯ä¸ªçŠ¶æ€å†…éƒ¨:

1. **å³é”®** â†’ **Linked Anim Layers** â†’ é€‰æ‹©å¯¹åº”å‡½æ•°
2. ä¾‹å¦‚åœ¨ Idle State ä¸­:
   - æ·»åŠ  `FullBody_IdleState` èŠ‚ç‚¹
   - è¿žæŽ¥åˆ° Output

### è®©ä¸» ABP å®žçŽ°æŽ¥å£

1. æ‰“å¼€ `ABP_DJ01Character_Base` çš„ **Class Settings**
2. åœ¨ **Interfaces** ä¸­æ·»åŠ  `ALI_DJ01AnimLayers`
3. å®žçŽ°é»˜è®¤çš„å±‚å‡½æ•° (ç”¨äºŽæ— æ­¦å™¨çŠ¶æ€)

---

## 2.7 å®Œæ•´ AnimGraph ç¤ºæ„

```
                    AnimGraph
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   LocomotionSM                             â”‚
â”‚                                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚                                                  â”‚     â”‚
â”‚   â”‚  [Idle] â†â”€â”€â†’ [Moving] â†â”€â”€â†’ [Jump States]       â”‚     â”‚
â”‚   â”‚     â”‚            â”‚              â”‚               â”‚     â”‚
â”‚   â”‚     â–¼            â–¼              â–¼               â”‚     â”‚
â”‚   â”‚  FullBody_   FullBody_    FullBody_Jump...     â”‚     â”‚
â”‚   â”‚  IdleState   MovingState                        â”‚     â”‚
â”‚   â”‚                                                  â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                          â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  Slot 'Default'  â”‚ â† Montage åœ¨æ­¤æ’­æ”¾
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Blend by Bool (bIsStunned)                  â”‚
â”‚                                                             â”‚
â”‚   False â”€â”€â†’ [æ¥è‡ªSlotçš„Pose]                               â”‚
â”‚   True  â”€â”€â†’ [Stunned Additive Anim]                        â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚   Output Pose    â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2.8 EventGraph é…ç½®

### åˆå§‹åŒ– GAS ç»‘å®š

åœ¨ EventGraph ä¸­:

```
Event Blueprint Initialize Animation
          â”‚
          â–¼
   [Try Get Pawn Owner] â”€â”€â†’ [Get Component by Class: AbilitySystemComponent]
                                        â”‚
                                        â–¼
                         [Initialize With Ability System]
                                   (è°ƒç”¨çˆ¶ç±»å‡½æ•°)
```

### æ›´æ–°åŠ¨ç”»æ•°æ®

```
Event Blueprint Update Animation
          â”‚
          â”œâ”€â”€â†’ [æ›´æ–° GroundSpeed]
          â”‚         Get Velocity â†’ Vector Length XY â†’ Set GroundSpeed
          â”‚
          â””â”€â”€â†’ [æ›´æ–° GroundDistance]
                    Line Trace â†’ Set GroundDistance
```

---

## 2.9 éªŒè¯æ¸…å•

### ç¼–è¯‘æ£€æŸ¥

- [ ] åŠ¨ç”»è“å›¾æ— ç¼–è¯‘é”™è¯¯
- [ ] æ‰€æœ‰åŠ¨ç”»å±‚å‡½æ•°æœ‰å®žçŽ° (è‡³å°‘è¿”å›žç©ºPose)
- [ ] çŠ¶æ€æœºè½¬æ¢é€»è¾‘æ­£ç¡®

### è¿è¡Œæ—¶æ£€æŸ¥

- [ ] è§’è‰²ç«™ç«‹æ—¶æ’­æ”¾ Idle åŠ¨ç”»
- [ ] è§’è‰²ç§»åŠ¨æ—¶åˆ‡æ¢åˆ° Moving åŠ¨ç”»
- [ ] è·³è·ƒæ—¶è§¦å‘ Jump çŠ¶æ€åºåˆ—
- [ ] BindingSet å˜é‡æ­£ç¡®æ›´æ–°

### è°ƒè¯•æŠ€å·§

1. **å¯ç”¨åŠ¨ç”»è°ƒè¯•æ˜¾ç¤º**:
   ```
   æŽ§åˆ¶å°: ShowDebug Animation
   ```

2. **æŸ¥çœ‹çŠ¶æ€æœºçŠ¶æ€**:
   - åœ¨ AnimGraph ç¼–è¾‘å™¨ä¸­å‹¾é€‰ **Show State Weights**

3. **æ£€æŸ¥å˜é‡å€¼**:
   - åœ¨ AnimGraph ç¼–è¾‘å™¨ä¸­å‹¾é€‰ **Show Variable Values**

---

## 2.10 å¸¸è§é—®é¢˜

### Q: çŠ¶æ€æœºä¸åˆ‡æ¢çŠ¶æ€

**å¯èƒ½åŽŸå› **:
1. è½¬æ¢æ¡ä»¶å˜é‡æœªæ›´æ–°
2. æ¡ä»¶é˜ˆå€¼è®¾ç½®ä¸å½“

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥ `NativeUpdateAnimation` æ˜¯å¦æ­£ç¡®æ›´æ–° `GroundSpeed`
- åœ¨ EventGraph ä¸­æ·»åŠ  Print è°ƒè¯•

### Q: åŠ¨ç”»å±‚è°ƒç”¨è¿”å›žç©º Pose

**å¯èƒ½åŽŸå› **:
1. æ²¡æœ‰é“¾æŽ¥æ­¦å™¨åŠ¨ç”»è“å›¾
2. æ­¦å™¨åŠ¨ç”»è“å›¾æœªå®žçŽ°è¯¥å‡½æ•°

**è§£å†³æ–¹æ¡ˆ**:
- åœ¨ä¸» ABP ä¸­æä¾›é»˜è®¤å®žçŽ°
- ç¡®ä¿åœ¨è§’è‰²åˆå§‹åŒ–æ—¶è°ƒç”¨ `LinkAnimClassLayers`

### Q: Montage ä¸æ’­æ”¾

**å¯èƒ½åŽŸå› **:
1. Slot åç§°ä¸åŒ¹é…
2. Montage çš„ Slot ä¸Ž AnimGraph ä¸­çš„ä¸åŒ

**è§£å†³æ–¹æ¡ˆ**:
- ç»Ÿä¸€ä½¿ç”¨ `DefaultGroup.DefaultSlot`
- æ£€æŸ¥è’™å¤ªå¥‡çš„ Slot è®¾ç½®

---

## 2.11 ä¸‹ä¸€æ­¥

å®Œæˆæœ¬ç« åŽï¼Œä½ åº”è¯¥æœ‰:

âœ… ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ä¸»åŠ¨ç”»è“å›¾ (`ABP_DJ01Character_Base`)  
âœ… åŒ…å« Idle/Moving/Jump çŠ¶æ€çš„çŠ¶æ€æœº  
âœ… é…ç½®å¥½çš„ Montage Slot  
âœ… å¯¹åŠ¨ç”»å±‚ç³»ç»Ÿçš„ç†è§£

æŽ¥ä¸‹æ¥æˆ‘ä»¬å°†åˆ›å»ºæ­¦å™¨ç‰¹å®šçš„åŠ¨ç”»å±‚è“å›¾ã€‚

---

ðŸ‘‰ **[è¿›å…¥ç¬¬ä¸‰ç« ï¼šåŠ¨ç”»å±‚ç³»ç»Ÿ](./03_AnimLayers.md)**