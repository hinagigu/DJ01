# 第0章：概述与语言基础

## 什么是 UE-Angelscript？

UE-Angelscript 是 Unreal Engine 的一个特殊分支，由 Hazelight Studios（《双人成行》开发商）维护。它将 AngelScript 脚本语言深度集成到虚幻引擎中，提供了一种介于 C++ 和蓝图之间的开发方式。

```
性能对比（相对值）：
┌─────────────────────────────────────────────────┐
│ C++ Native    ████████████████████████████ 100% │
│ AngelScript   ██████████████████████       80%  │
│ Blueprint     ████████                     30%  │
└─────────────────────────────────────────────────┘
```

## 核心组成

UE-Angelscript 的实现包含两大部分：

1. **对 UE 源码的修改** - 分散在引擎各处，通过 `// HAZE FIX` 注释标记
2. **Angelscript 插件本身** - 位于 `Engine/Plugins/Angelscript/`

## 为什么选择 AngelScript？

| 特性 | AngelScript | Lua | Python |
|------|-------------|-----|--------|
| **性能** | 接近 C++ | 中等 | 较低 |
| **类型系统** | 强类型、静态 | 动态 | 动态 |
| **语法** | 类似 C++ | 独特 | 独特 |
| **UE 集成** | 原生级别 | 需要桥接 | 需要桥接 |
| **热重载** | ✅ 支持 | ✅ 支持 | ✅ 支持 |
| **调试** | IDE 集成 | 有限 | 有限 |

---

## AngelScript 语言基础

> 在深入 UE 集成之前，需要先理解 AngelScript 的核心概念。

### 基本语法

AngelScript 的语法与 C++ 非常相似：

```angelscript
// 类定义
class MyClass
{
    // 成员变量
    int Value;
    FString Name;
    
    // 构造函数
    MyClass()
    {
        Value = 0;
        Name = "Default";
    }
    
    // 成员函数
    void SetValue(int NewValue)
    {
        Value = NewValue;
    }
    
    // 带返回值的函数
    int GetValue() const
    {
        return Value;
    }
}
```

### 句柄（Handle）与值类型

AngelScript 中最重要的概念之一是**句柄**（Handle），用 `@` 符号表示：

```angelscript
// 值类型 - 栈上分配，自动管理生命周期
FVector Position;
Position.X = 100.0f;

// 句柄类型 - 类似 C++ 指针，指向堆上对象
AActor@ ActorRef = nullptr;
ActorRef = SpawnActor(SomeClass);

// 句柄赋值 vs 值赋值
AActor@ Actor1 = GetActor();
AActor@ Actor2 = Actor1;      // Actor2 和 Actor1 指向同一对象
AActor@ Actor3;
@Actor3 = @Actor1;            // 显式句柄赋值（等同上一行）
```

### 类型分类

```
AngelScript 类型
├── 基础类型 (Primitive Types)
│   ├── bool
│   ├── int8, int16, int32, int64
│   ├── uint8, uint16, uint32, uint64
│   ├── float32 (float)
│   └── float64 (double)
│
├── 值类型 (Value Types)
│   ├── 结构体 (struct)
│   └── 用户定义的值类
│
└── 引用类型 (Reference Types)
    ├── 类 (class)
    └── 接口 (interface)
```

### 与 C++ 的类型映射

| C++ 类型 | AngelScript 类型 | 说明 |
|----------|-----------------|------|
| `bool` | `bool` | 直接对应 |
| `int32` | `int` / `int32` | 默认整数 |
| `float` | `float32` | 注意不是 `float` |
| `double` | `float64` | 双精度 |
| `FString` | `FString` | 值类型 |
| `FVector` | `FVector` | 值类型 |
| `UObject*` | `UObject` | 隐式句柄 |
| `AActor*` | `AActor` | 隐式句柄 |
| `TSubclassOf<T>` | `TSubclassOf<T>` | 类引用 |

---

**下一章**: [01_插件架构.md](./01_插件架构.md) - 了解插件的目录结构和模块关系