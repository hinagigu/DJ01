---
status: todo
progress: 0
milestones: 2
completed: 0
priority: P0
phase: overview
tags: [architecture, overview]
---

# 00 - åˆ†å¸ƒå¼å¤šDSæ¶æ„æ€»è§ˆ

## ğŸ“‹ é‡Œç¨‹ç¢‘è¿½è¸ª

| # | é‡Œç¨‹ç¢‘ | çŠ¶æ€ | éªŒæ”¶æ ‡å‡† |
|---|--------|:----:|----------|
| M1 | æ–‡æ¡£ç†è§£ | â¬œ | ç†è§£æ•´ä½“æ¶æ„å’ŒæŠ€æœ¯æ ˆ |
| M2 | é¡¹ç›®ç»“æ„ | â¬œ | åˆ›å»ºGoå’ŒUE5ç›®å½•ç»“æ„ |

> **è¿›åº¦**: 0/2 = 0%

---

### M1: æ–‡æ¡£ç†è§£

- [ ] ç†è§£Go/UE5åˆ†å·¥
- [ ] ç†è§£5ä¸ªPhaseçš„ç›®æ ‡
- [ ] ç†è§£æœåŠ¡åœ°å€ç¼–ç æ¦‚å¿µ
- [ ] ç†è§£åœºæ™¯åˆ†å‰²æ¦‚å¿µ

**å®Œæˆæ—¥æœŸ**: ____

---

### M2: é¡¹ç›®ç»“æ„åˆ›å»º

**Goä¾§**:
- [ ] åˆ›å»º `ServerGo/` ç›®å½•
- [ ] è¿è¡Œ `go mod init`
- [ ] åˆ›å»º `cmd/` å­ç›®å½•
- [ ] åˆ›å»º `internal/` å­ç›®å½•
- [ ] åˆ›å»º `pkg/` å­ç›®å½•

**UE5ä¾§**:
- [ ] åˆ›å»º `Source/DJ01/Network/` ç›®å½•
- [ ] åˆ›å»º `Distributed/` å­ç›®å½•
- [ ] åˆ›å»º `Ghost/` å­ç›®å½•
- [ ] åˆ›å»º `ScenePartition/` å­ç›®å½•

**Protoä¾§**:
- [ ] åˆ›å»º `Proto/` ç›®å½•

**éªŒæ”¶**: ç›®å½•ç»“æ„ä¸æ–‡æ¡£ä¸€è‡´

**å®Œæˆæ—¥æœŸ**: ____

---

## é¡¹ç›®ç›®æ ‡

æ„å»ºä¸€ä¸ª**ä¼ä¸šçº§åˆ†å¸ƒå¼MMOæœåŠ¡å™¨æ¶æ„Demo**ï¼Œå±•ç¤ºä»¥ä¸‹æ ¸å¿ƒèƒ½åŠ›ï¼š

| èƒ½åŠ› | è¯´æ˜ | æŠ€æœ¯è¦ç‚¹ |
|------|------|---------|
| **åœºæ™¯åˆ†å‰²** | å¤§ä¸–ç•Œåˆ‡å‰²åˆ°å¤šä¸ªDSèŠ‚ç‚¹ | World Partition + Zoneåˆ’åˆ† |
| **è·¨DSåŒæ­¥** | DSè¾¹ç•ŒåŒºåŸŸçš„å®ä½“åŒæ­¥ | Ghostå®ä½“ + å¢é‡åŒæ­¥ |
| **æ¶ˆæ¯è·¯ç”±** | ç‹¬ç«‹è¿›ç¨‹æ¶ˆæ¯ä¸­è½¬ | Switcher + æœåŠ¡å‘ç° |
| **æ— ç¼ä¼ é€** | ç©å®¶è·¨DSè¿ç§» | æƒå¨è½¬ç§» + çŠ¶æ€è¿ç§» |

---

## æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| **æ¸¸æˆé€»è¾‘** | UE5 C++ | DSèŠ‚ç‚¹ã€GASæˆ˜æ–—ã€ç‰©ç† |
| **ç‹¬ç«‹è¿›ç¨‹** | **Go** | Masterã€Switcherã€Gateway |
| **é€šä¿¡åè®®** | TCP + Protobuf | ä½å»¶è¿Ÿã€å¼ºç±»å‹ |
| **å­˜å‚¨** | Redis + MySQL | ç¼“å­˜ + æŒä¹…åŒ– |

> ğŸ’¡ é€‰æ‹©Goçš„åŸå› ï¼šåŸç”Ÿgoroutineå¹¶å‘ã€net/httpæˆç†Ÿã€å•äºŒè¿›åˆ¶éƒ¨ç½²ã€æ¸¸æˆæœåŠ¡å™¨ä¸»æµé€‰æ‹©

---

## ç³»ç»Ÿæ¶æ„å›¾

```mermaid
graph TB
    subgraph å®¢æˆ·ç«¯
        C[UE5 Client]
    end
    
    subgraph Goç‹¬ç«‹è¿›ç¨‹
        GW[Gateway<br/>å®¢æˆ·ç«¯æ¥å…¥]
        SW[Switcher<br/>æ¶ˆæ¯è·¯ç”±]
        Master[Master<br/>å…¨å±€è°ƒåº¦]
    end
    
    subgraph UE5 DSé›†ç¾¤
        DS1[DS Zone-A]
        DS2[DS Zone-B]
        DS3[DS Zone-C]
        DS4[DS Zone-D]
    end
    
    subgraph å­˜å‚¨
        Redis[(Redis)]
        MySQL[(MySQL)]
    end
    
    C --> GW
    GW --> SW
    SW <--> Master
    SW <--> DS1
    SW <--> DS2
    SW <--> DS3
    SW <--> DS4
    
    DS1 <-.Ghost.-> DS2
    DS1 <-.Ghost.-> DS3
    
    Master --> Redis
    Redis --> MySQL
    
    style SW fill:#98FB98
    style Master fill:#FFB6C1
```

---

## è¿›ç¨‹èŒè´£

| è¿›ç¨‹ | è¯­è¨€ | æ ¸å¿ƒèŒè´£ |
|------|------|---------|
| **Gateway** | Go | å®¢æˆ·ç«¯é•¿è¿æ¥ã€åè®®è½¬æ¢ã€DDoSé˜²æŠ¤ |
| **Switcher** | Go | æœåŠ¡é—´RPCè·¯ç”±ã€æ¶ˆæ¯åˆ†å‘ã€è´Ÿè½½æ„ŸçŸ¥ |
| **Master** | Go | æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡ã€ç©å®¶è·¯ç”±ã€Zoneç®¡ç† |
| **DS** | UE5 C++ | æ¸¸æˆé€»è¾‘ã€GASæˆ˜æ–—ã€ç‰©ç†ã€AI |

---

## æœåŠ¡åœ°å€ç¼–ç  (32ä½)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Bit 31-24   â”‚  Bit 23-16    â”‚  Bit 15-0              â”‚
â”‚  ServerId    â”‚  ServiceType  â”‚  ServiceIndex          â”‚
â”‚  åŒºæœID      â”‚  æœåŠ¡ç±»å‹     â”‚  å®ä¾‹ç´¢å¼•              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æœåŠ¡ç±»å‹æšä¸¾**ï¼š
- `0x01` Master
- `0x02` Switcher  
- `0x03` Gateway
- `0x10` GAS (DS)
- `0x11` Chat
- `0x12` Match

---

## åœºæ™¯åˆ†å‰²æ¦‚å¿µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           å¤§ä¸–ç•Œ 8km Ã— 8km              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Zone(0,0)   â”‚   Zone(1,0)   â”‚   ...   â”‚
â”‚   DS-1        â”‚   DS-2        â”‚         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”‚         â”‚
â”‚   â”‚è¾¹ç•Œå¸¦ â”‚â—„â”€â”€â”¼â”€â”€â–ºâ”‚è¾¹ç•Œå¸¦ â”‚   â”‚         â”‚
â”‚   â”‚ 200m  â”‚   â”‚   â”‚ 200m  â”‚   â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Zone(0,1)   â”‚   Zone(1,1)   â”‚   ...   â”‚
â”‚   DS-3        â”‚   DS-4        â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®æ¦‚å¿µ**ï¼š
- **Zone**ï¼š2kmÃ—2km çš„ä¸–ç•Œåˆ†åŒºï¼Œæ¯ä¸ªZoneç”±ä¸€ä¸ªDSè´Ÿè´£
- **è¾¹ç•Œå¸¦**ï¼šZoneè¾¹ç¼˜200mèŒƒå›´ï¼Œè¿›å…¥ååˆ›å»ºGhost
- **Ghostå®ä½“**ï¼šåœ¨ç›¸é‚»DSçš„åªè¯»å‰¯æœ¬ï¼Œç”¨äºè·¨è¾¹ç•Œå¯è§æ€§
- **æƒå¨è½¬ç§»**ï¼šç©å®¶è·¨è¶ŠZoneä¸­çº¿æ—¶ï¼Œæƒå¨DSåˆ‡æ¢

---

## æ–‡æ¡£ç´¢å¼•

| # | æ–‡æ¡£ | å†…å®¹æ¦‚è¦ | ä¼˜å…ˆçº§ |
|---|------|---------|-------|
| 01 | [01_ServiceAddress.md](./01_ServiceAddress.md) | æœåŠ¡åœ°å€ç¼–ç è§„èŒƒ | P0 |
| 02 | [02_Switcher.md](./02_Switcher.md) | Switcherè®¾è®¡çº²è¦ | P0 |
| 03 | [03_Master.md](./03_Master.md) | Masterè®¾è®¡çº²è¦ | P0 |
| 04 | [04_Gateway.md](./04_Gateway.md) | Gatewayè®¾è®¡çº²è¦ | P1 |
| 05 | [05_MessageProtocol.md](./05_MessageProtocol.md) | æ¶ˆæ¯åè®®å®šä¹‰ | P0 |
| 06 | [06_SceneSegmentation.md](./06_SceneSegmentation.md) | åœºæ™¯åˆ†å‰²ç­–ç•¥ | P1 |
| 07 | [07_GhostEntity.md](./07_GhostEntity.md) | Ghostå®ä½“ç³»ç»Ÿ | P1 |
| 08 | [08_AuthorityTransfer.md](./08_AuthorityTransfer.md) | æƒå¨è½¬ç§»æœºåˆ¶ | P1 |
| 09 | [09_DS_Integration.md](./09_DS_Integration.md) | UE5 DSé›†æˆ | P1 |
| 10 | [10_TestPlan.md](./10_TestPlan.md) | æµ‹è¯•ä¸æ¼”ç¤ºè®¡åˆ’ | P2 |

---

## ä»£ç ç›®å½•è§„åˆ’

```
DJ01/
â”œâ”€â”€ Source/DJ01/Network/
â”‚   â”œâ”€â”€ Distributed/          # UE5ä¾§åˆ†å¸ƒå¼æ¨¡å—
â”‚   â”œâ”€â”€ Ghost/                # Ghostå®ä½“
â”‚   â””â”€â”€ ScenePartition/       # åœºæ™¯åˆ†å‰²
â”‚
â”œâ”€â”€ ServerGo/                 # GoæœåŠ¡ç«¯ (æ–°å»º)
â”‚   â”œâ”€â”€ cmd/
â”‚   â”‚   â”œâ”€â”€ master/           # Masterå…¥å£
â”‚   â”‚   â”œâ”€â”€ switcher/         # Switcherå…¥å£
â”‚   â”‚   â””â”€â”€ gateway/          # Gatewayå…¥å£
â”‚   â”œâ”€â”€ internal/
â”‚   â”‚   â”œâ”€â”€ protocol/         # åè®®å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ service/          # æœåŠ¡é€»è¾‘
â”‚   â”‚   â””â”€â”€ registry/         # æœåŠ¡æ³¨å†Œ
â”‚   â””â”€â”€ go.mod
â”‚
â””â”€â”€ Proto/                    # Protobufå®šä¹‰
    â”œâ”€â”€ common.proto
    â”œâ”€â”€ service.proto
    â””â”€â”€ game.proto
```

---

## å¼€å‘é˜¶æ®µ

### Phase 1: é€šä¿¡åŸºç¡€ (Week 1)
- [ ] æœåŠ¡åœ°å€ç¼–ç  (Go + UE5)
- [ ] æ¶ˆæ¯åè®®å®šä¹‰ (Protobuf)
- [ ] Switcheréª¨æ¶
- [ ] UE5 SwitcherClient

### Phase 2: æœåŠ¡åè°ƒ (Week 2)  
- [ ] MasteræœåŠ¡å‘ç°
- [ ] DSè‡ªåŠ¨æ³¨å†Œ
- [ ] å¿ƒè·³ä¸å¥åº·æ£€æŸ¥
- [ ] è´Ÿè½½å‡è¡¡

### Phase 3: åœºæ™¯åˆ†å‰² (Week 3)
- [ ] Zoneè¾¹ç•Œæ£€æµ‹
- [ ] Ghostå®ä½“åˆ›å»º/é”€æ¯
- [ ] è·¨DSçŠ¶æ€åŒæ­¥
- [ ] æƒå¨è½¬ç§»

### Phase 4: æ¼”ç¤ºé›†æˆ (Week 4)
- [ ] 2Ã—2 Zoneæµ‹è¯•åœ°å›¾
- [ ] è¾¹ç•Œç©¿è¶Šæ¼”ç¤º
- [ ] Debug HUD
- [ ] æ€§èƒ½æµ‹è¯•

---

## ä¸‹ä¸€æ­¥

ä» **[01_ServiceAddress.md](./01_ServiceAddress.md)** å¼€å§‹ï¼Œå®šä¹‰æœåŠ¡åœ°å€çš„ç¼–ç è§„èŒƒã€‚